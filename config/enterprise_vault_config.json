{
  "vault": {
    "name": "hAIveMind Enterprise Credential Vault",
    "version": "1.0.0",
    "environment": "production",
    "debug": false,
    "api": {
      "host": "0.0.0.0",
      "port": 8080,
      "workers": 4,
      "max_connections": 1000,
      "keepalive_timeout": 30,
      "request_timeout": 60,
      "max_request_size": 10485760,
      "cors": {
        "enabled": true,
        "allowed_origins": [
          "https://vault.haivemind.local",
          "https://admin.haivemind.local"
        ],
        "allowed_methods": ["GET", "POST", "PUT", "DELETE", "OPTIONS"],
        "allowed_headers": ["*"],
        "allow_credentials": true
      },
      "rate_limiting": {
        "enabled": true,
        "default_limit": "100/minute",
        "auth_limit": "10/minute",
        "admin_limit": "30/minute",
        "storage": "redis"
      }
    },
    "database": {
      "url": "${VAULT_DATABASE_URL}",
      "pool_size": 20,
      "max_overflow": 30,
      "pool_timeout": 30,
      "pool_recycle": 3600,
      "echo": false,
      "ssl_mode": "require",
      "ssl_cert": "/etc/ssl/certs/vault-client.crt",
      "ssl_key": "/etc/ssl/private/vault-client.key",
      "ssl_ca": "/etc/ssl/certs/ca-bundle.crt"
    },
    "redis": {
      "url": "${VAULT_REDIS_URL}",
      "password": "${VAULT_REDIS_PASSWORD}",
      "db": 0,
      "max_connections": 50,
      "retry_on_timeout": true,
      "socket_timeout": 5,
      "socket_connect_timeout": 5,
      "health_check_interval": 30,
      "ssl": {
        "enabled": true,
        "cert_reqs": "required",
        "ca_certs": "/etc/ssl/certs/ca-bundle.crt",
        "certfile": "/etc/ssl/certs/vault-redis.crt",
        "keyfile": "/etc/ssl/private/vault-redis.key"
      }
    },
    "encryption": {
      "algorithm": "AES-256-GCM",
      "key_derivation": "Argon2",
      "pbkdf2_iterations": 100000,
      "argon2_time_cost": 3,
      "argon2_memory_cost": 65536,
      "argon2_parallelism": 1,
      "salt_length": 32,
      "nonce_length": 12,
      "key_length": 32,
      "key_rotation": {
        "enabled": true,
        "interval_days": 90,
        "overlap_period_days": 30,
        "auto_rotation": true
      }
    },
    "hsm": {
      "enabled": true,
      "providers": {
        "aws_cloudhsm": {
          "enabled": false,
          "cluster_id": "${AWS_CLOUDHSM_CLUSTER_ID}",
          "user": "${AWS_CLOUDHSM_USER}",
          "password": "${AWS_CLOUDHSM_PASSWORD}",
          "key_label": "vault_master_key",
          "region": "us-east-1"
        },
        "azure_hsm": {
          "enabled": false,
          "vault_url": "${AZURE_KEY_VAULT_URL}",
          "client_id": "${AZURE_CLIENT_ID}",
          "client_secret": "${AZURE_CLIENT_SECRET}",
          "tenant_id": "${AZURE_TENANT_ID}",
          "key_name": "vault-master-key"
        },
        "yubihsm2": {
          "enabled": true,
          "connector_url": "http://localhost:12345",
          "auth_key_id": 1,
          "auth_key": "${YUBIHSM2_AUTH_KEY}",
          "key_id": 100,
          "key_label": "vault_master_key"
        }
      }
    },
    "authentication": {
      "jwt_secret": "${VAULT_JWT_SECRET}",
      "jwt_algorithm": "HS256",
      "session_timeout_hours": 8,
      "max_sessions_per_user": 5,
      "password_policy": {
        "min_length": 12,
        "max_length": 128,
        "require_uppercase": true,
        "require_lowercase": true,
        "require_numbers": true,
        "require_special_chars": true,
        "special_chars": "!@#$%^&*()_+-=[]{}|;:,.<>?",
        "max_age_days": 90,
        "history_count": 12,
        "lockout_attempts": 5,
        "lockout_duration_minutes": 30
      },
      "mfa": {
        "enabled": true,
        "required_for_admins": true,
        "methods": ["totp", "webauthn"],
        "totp": {
          "issuer": "hAIveMind Vault",
          "window": 1,
          "backup_codes": 10
        },
        "webauthn": {
          "rp_name": "hAIveMind Vault",
          "rp_id": "vault.haivemind.local",
          "origin": "https://vault.haivemind.local"
        }
      }
    },
    "ldap": {
      "enabled": true,
      "server": "${LDAP_SERVER}",
      "port": 636,
      "use_ssl": true,
      "use_tls": false,
      "bind_dn": "${LDAP_BIND_DN}",
      "bind_password": "${LDAP_BIND_PASSWORD}",
      "base_dn": "${LDAP_BASE_DN}",
      "user_search_base": "OU=Users,${LDAP_BASE_DN}",
      "user_search_filter": "(sAMAccountName={username})",
      "user_attributes": [
        "sAMAccountName",
        "mail",
        "givenName",
        "sn",
        "memberOf",
        "userPrincipalName"
      ],
      "group_search_base": "OU=Groups,${LDAP_BASE_DN}",
      "group_search_filter": "(objectClass=group)",
      "group_attributes": ["cn", "member"],
      "timeout": 30,
      "auto_bind": true,
      "sync_interval_hours": 24,
      "role_mapping": {
        "CN=Vault Admins,OU=Groups,${LDAP_BASE_DN}": "super_admin",
        "CN=Security Team,OU=Groups,${LDAP_BASE_DN}": "security_admin",
        "CN=DevOps Team,OU=Groups,${LDAP_BASE_DN}": "organization_admin",
        "CN=Developers,OU=Groups,${LDAP_BASE_DN}": "developer"
      }
    },
    "compliance": {
      "enabled": true,
      "standards": ["soc2_type2", "hipaa", "pci_dss", "gdpr", "iso27001"],
      "audit": {
        "enabled": true,
        "retention_days": 2555,
        "log_sensitive_data": false,
        "high_risk_events": [
          "credential_delete",
          "user_create",
          "role_assignment",
          "emergency_access",
          "admin_action"
        ],
        "export_formats": ["csv", "json", "xml"],
        "encryption_at_rest": true
      },
      "reporting": {
        "enabled": true,
        "auto_generate": true,
        "schedule": "monthly",
        "recipients": [
          "security@company.com",
          "compliance@company.com"
        ],
        "formats": ["pdf", "json"]
      },
      "checks": {
        "enabled": true,
        "schedule": "daily",
        "alert_on_violations": true,
        "auto_remediation": false
      }
    },
    "backup": {
      "enabled": true,
      "encryption": true,
      "compression": true,
      "schedule": {
        "full_backup": "0 2 * * 0",
        "incremental_backup": "0 2 * * 1-6",
        "transaction_log_backup": "*/15 * * * *"
      },
      "retention": {
        "daily_backups": 30,
        "weekly_backups": 12,
        "monthly_backups": 12,
        "yearly_backups": 7
      },
      "storage": {
        "local": {
          "enabled": true,
          "path": "/var/backups/vault",
          "max_size_gb": 100
        },
        "s3": {
          "enabled": true,
          "bucket": "${VAULT_BACKUP_S3_BUCKET}",
          "region": "us-east-1",
          "access_key": "${AWS_ACCESS_KEY_ID}",
          "secret_key": "${AWS_SECRET_ACCESS_KEY}",
          "encryption": "AES256",
          "storage_class": "STANDARD_IA"
        },
        "azure": {
          "enabled": false,
          "account_name": "${AZURE_STORAGE_ACCOUNT}",
          "account_key": "${AZURE_STORAGE_KEY}",
          "container": "vault-backups"
        }
      }
    },
    "monitoring": {
      "enabled": true,
      "metrics": {
        "enabled": true,
        "endpoint": "/metrics",
        "port": 9090,
        "interval": 30
      },
      "health_checks": {
        "enabled": true,
        "endpoint": "/health",
        "detailed_endpoint": "/health/detailed",
        "interval": 30,
        "timeout": 10
      },
      "logging": {
        "level": "INFO",
        "format": "json",
        "output": "stdout",
        "file": {
          "enabled": true,
          "path": "/var/log/vault/vault.log",
          "max_size_mb": 100,
          "backup_count": 10,
          "rotation": "daily"
        },
        "syslog": {
          "enabled": true,
          "host": "syslog.company.com",
          "port": 514,
          "facility": "local0"
        }
      },
      "alerting": {
        "enabled": true,
        "channels": {
          "email": {
            "enabled": true,
            "smtp_server": "${SMTP_SERVER}",
            "smtp_port": 587,
            "username": "${SMTP_USERNAME}",
            "password": "${SMTP_PASSWORD}",
            "from": "vault-alerts@company.com",
            "to": ["security@company.com", "devops@company.com"]
          },
          "slack": {
            "enabled": true,
            "webhook_url": "${SLACK_WEBHOOK_URL}",
            "channel": "#security-alerts"
          },
          "pagerduty": {
            "enabled": true,
            "integration_key": "${PAGERDUTY_INTEGRATION_KEY}"
          }
        },
        "rules": [
          {
            "name": "High Risk Event",
            "condition": "risk_score >= 0.8",
            "severity": "critical",
            "channels": ["email", "slack", "pagerduty"]
          },
          {
            "name": "Failed Authentication",
            "condition": "event_type == 'auth_failure' AND count > 5",
            "severity": "warning",
            "channels": ["email", "slack"]
          },
          {
            "name": "Database Connection Error",
            "condition": "component == 'database' AND status == 'unhealthy'",
            "severity": "critical",
            "channels": ["email", "pagerduty"]
          }
        ]
      }
    },
    "haivemind": {
      "enabled": true,
      "agent_id": "vault_security_agent",
      "machine_id": "${HAIVEMIND_MACHINE_ID}",
      "memory_server_url": "${HAIVEMIND_MEMORY_SERVER_URL}",
      "api_token": "${HAIVEMIND_API_TOKEN}",
      "capabilities": [
        "credential_monitoring",
        "access_control",
        "authentication_analysis",
        "privilege_management",
        "security_compliance",
        "threat_detection",
        "anomaly_detection",
        "incident_response"
      ],
      "analytics": {
        "enabled": true,
        "behavioral_analysis": true,
        "pattern_recognition": true,
        "anomaly_detection": true,
        "risk_assessment": true,
        "threat_hunting": true,
        "predictive_analysis": true,
        "correlation_analysis": true,
        "trend_analysis": true
      },
      "intelligence_sharing": {
        "enabled": true,
        "classification_level": "tlp_amber",
        "share_anonymized_patterns": true,
        "share_threat_indicators": true,
        "collaborative_response": true
      },
      "threat_intel_feeds": [
        {
          "name": "internal_vault_intel",
          "type": "internal",
          "enabled": true
        },
        {
          "name": "haivemind_collective_intel",
          "type": "collective",
          "enabled": true
        },
        {
          "name": "mitre_attack",
          "type": "external",
          "enabled": true,
          "url": "https://attack.mitre.org/",
          "update_interval_hours": 24
        },
        {
          "name": "cisa_known_exploited",
          "type": "external",
          "enabled": true,
          "url": "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
          "update_interval_hours": 6
        }
      ]
    },
    "security": {
      "tls": {
        "enabled": true,
        "min_version": "1.2",
        "cert_file": "/etc/ssl/certs/vault.crt",
        "key_file": "/etc/ssl/private/vault.key",
        "ca_file": "/etc/ssl/certs/ca-bundle.crt",
        "verify_client": false,
        "ciphers": [
          "ECDHE-RSA-AES256-GCM-SHA384",
          "ECDHE-RSA-AES128-GCM-SHA256",
          "ECDHE-RSA-AES256-SHA384",
          "ECDHE-RSA-AES128-SHA256"
        ]
      },
      "headers": {
        "strict_transport_security": "max-age=31536000; includeSubDomains",
        "content_security_policy": "default-src 'self'",
        "x_frame_options": "DENY",
        "x_content_type_options": "nosniff",
        "x_xss_protection": "1; mode=block",
        "referrer_policy": "strict-origin-when-cross-origin"
      },
      "ip_whitelist": [
        "10.0.0.0/8",
        "172.16.0.0/12",
        "192.168.0.0/16"
      ],
      "geo_blocking": {
        "enabled": true,
        "allowed_countries": ["US", "CA", "GB", "DE", "FR"],
        "blocked_countries": ["CN", "RU", "KP", "IR"]
      },
      "intrusion_detection": {
        "enabled": true,
        "max_requests_per_minute": 1000,
        "max_failed_auth_attempts": 5,
        "block_duration_minutes": 60,
        "suspicious_patterns": [
          "sql_injection",
          "xss_attempt",
          "directory_traversal",
          "command_injection"
        ]
      }
    },
    "performance": {
      "caching": {
        "enabled": true,
        "ttl_seconds": 300,
        "max_size_mb": 512,
        "compression": true
      },
      "connection_pooling": {
        "enabled": true,
        "max_connections": 100,
        "min_connections": 10,
        "connection_timeout": 30,
        "idle_timeout": 300
      },
      "optimization": {
        "enable_gzip": true,
        "enable_brotli": true,
        "static_file_caching": true,
        "database_query_optimization": true,
        "redis_pipelining": true
      }
    }
  }
}