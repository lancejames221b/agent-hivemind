{
  "vault": {
    "enterprise_features": {
      "enabled": true,
      "license_type": "enterprise",
      "deployment_mode": "high_availability",
      "compliance_mode": "strict"
    },
    
    "hsm": {
      "primary_hsm": {
        "provider": "aws_cloudhsm",
        "endpoint": "https://cloudhsm.us-east-1.amazonaws.com",
        "auth_token": "${AWS_CLOUDHSM_TOKEN}",
        "key_label": "vault_master_key",
        "partition_name": "vault_partition"
      },
      "backup_hsm": {
        "provider": "azure_hsm", 
        "endpoint": "https://vault.vault.azure.net",
        "auth_token": "${AZURE_HSM_TOKEN}",
        "key_label": "vault_backup_key"
      },
      "local_hsm": {
        "provider": "pkcs11",
        "endpoint": "/usr/lib/softhsm/libsofthsm2.so",
        "auth_token": "${PKCS11_PIN}",
        "key_label": "vault_local_key",
        "slot_id": 0
      }
    },
    
    "approval_policies": {
      "credential_access": {
        "approval_level": "low",
        "required_approvers": 1,
        "total_approvers": 2,
        "approver_roles": ["vault_admin", "security_officer"],
        "timeout_hours": 2,
        "emergency_bypass": true,
        "business_hours_only": false
      },
      "credential_deletion": {
        "approval_level": "high",
        "required_approvers": 3,
        "total_approvers": 5,
        "approver_roles": ["vault_admin", "security_officer", "compliance_officer"],
        "timeout_hours": 24,
        "emergency_bypass": false,
        "business_hours_only": true
      },
      "vault_configuration": {
        "approval_level": "critical",
        "required_approvers": 5,
        "total_approvers": 7,
        "approver_roles": ["vault_admin", "security_officer", "compliance_officer", "ciso"],
        "timeout_hours": 48,
        "emergency_bypass": false,
        "business_hours_only": true
      },
      "emergency_revocation": {
        "approval_level": "high",
        "required_approvers": 2,
        "total_approvers": 3,
        "approver_roles": ["incident_commander", "security_officer", "vault_admin"],
        "timeout_hours": 1,
        "emergency_bypass": true,
        "business_hours_only": false
      }
    },
    
    "escrow_policies": {
      "individual": {
        "retention_days": 90,
        "auto_recovery_triggers": ["user_disabled", "termination_date"],
        "required_approvers": 1,
        "authorized_recovery_roles": ["manager", "hr_admin"],
        "encryption_level": "AES-256-GCM",
        "audit_frequency_days": 30,
        "compliance_requirements": ["SOX", "PCI"]
      },
      "department": {
        "retention_days": 365,
        "auto_recovery_triggers": ["department_restructure"],
        "required_approvers": 2,
        "authorized_recovery_roles": ["department_head", "security_officer"],
        "encryption_level": "AES-256-GCM",
        "audit_frequency_days": 90,
        "compliance_requirements": ["SOX", "GDPR"]
      },
      "emergency": {
        "retention_days": 1095,
        "auto_recovery_triggers": ["disaster_declared", "emergency_activation"],
        "required_approvers": 3,
        "authorized_recovery_roles": ["incident_commander", "ciso", "ceo"],
        "encryption_level": "AES-256-GCM",
        "audit_frequency_days": 7,
        "compliance_requirements": ["SOX", "HIPAA", "PCI"]
      }
    },
    
    "threat_detection": {
      "enabled": true,
      "auto_train_models": true,
      "enable_real_time": true,
      "ml_models": {
        "isolation_forest": {
          "contamination": 0.1,
          "n_estimators": 200
        },
        "neural_network": {
          "hidden_layers": [100, 50],
          "activation": "relu",
          "solver": "adam",
          "max_iter": 1000
        },
        "clustering": {
          "algorithm": "dbscan",
          "eps": 0.5,
          "min_samples": 5
        }
      },
      "threat_thresholds": {
        "low": 0.3,
        "medium": 0.6,
        "high": 0.8,
        "critical": 0.95
      }
    },
    
    "siem_integration": {
      "splunk": {
        "provider": "splunk",
        "endpoint": "https://splunk.company.com:8089",
        "api_key": "${SPLUNK_API_KEY}",
        "index_name": "vault_security",
        "source_type": "vault_enterprise",
        "batch_size": 100,
        "verify_ssl": true
      },
      "elastic": {
        "provider": "elastic_siem",
        "endpoint": "https://elasticsearch.company.com:9200",
        "api_key": "${ELASTIC_API_KEY}",
        "index_name": "vault-security",
        "batch_size": 100,
        "verify_ssl": true
      },
      "qradar": {
        "provider": "qradar",
        "endpoint": "https://qradar.company.com/api",
        "api_key": "${QRADAR_SEC_TOKEN}",
        "batch_size": 50,
        "verify_ssl": true
      },
      "azure_sentinel": {
        "provider": "azure_sentinel",
        "endpoint": "https://management.azure.com",
        "api_key": "${AZURE_SENTINEL_TOKEN}",
        "organization_id": "${AZURE_SUBSCRIPTION_ID}",
        "batch_size": 100,
        "verify_ssl": true
      }
    },
    
    "threat_intel_feeds": [
      {
        "name": "internal_vault_intel",
        "type": "internal",
        "description": "Internal vault security intelligence"
      },
      {
        "name": "haivemind_collective_intel",
        "type": "collective", 
        "description": "Collective intelligence from hAIveMind network"
      },
      {
        "name": "mitre_attack",
        "type": "external",
        "description": "MITRE ATT&CK framework data",
        "endpoint": "https://attack.mitre.org/",
        "update_frequency": "weekly"
      },
      {
        "name": "cisa_known_exploited",
        "type": "external", 
        "description": "CISA Known Exploited Vulnerabilities",
        "endpoint": "https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json",
        "update_frequency": "daily"
      }
    ],
    
    "compliance": {
      "sox": {
        "enabled": true,
        "audit_retention_days": 2555,
        "required_controls": [
          "access_controls",
          "change_management", 
          "audit_trails",
          "separation_of_duties"
        ]
      },
      "pci_dss": {
        "enabled": true,
        "version": "4.0",
        "merchant_level": 1,
        "required_controls": [
          "encryption_at_rest",
          "encryption_in_transit",
          "access_controls",
          "monitoring",
          "vulnerability_management"
        ]
      },
      "hipaa": {
        "enabled": true,
        "covered_entity": true,
        "required_controls": [
          "phi_encryption",
          "access_logging",
          "minimum_necessary",
          "audit_controls"
        ]
      },
      "gdpr": {
        "enabled": true,
        "data_controller": true,
        "required_controls": [
          "data_minimization",
          "consent_management",
          "right_to_erasure",
          "data_protection_impact_assessment"
        ]
      },
      "iso27001": {
        "enabled": true,
        "certification_level": "full",
        "required_controls": [
          "information_security_policy",
          "risk_management",
          "access_control",
          "cryptography",
          "incident_management"
        ]
      }
    },
    
    "enterprise_integration": {
      "active_directory": {
        "enabled": false,
        "domain": "company.local",
        "ldap_server": "ldaps://dc.company.local:636",
        "bind_dn": "CN=vault_service,OU=Service Accounts,DC=company,DC=local",
        "bind_password": "${AD_BIND_PASSWORD}",
        "user_search_base": "OU=Users,DC=company,DC=local",
        "group_search_base": "OU=Groups,DC=company,DC=local"
      },
      "saml_sso": {
        "enabled": false,
        "identity_provider": "https://idp.company.com/auth/realms/master",
        "service_provider_metadata": "/etc/vault/sp-metadata.xml",
        "certificate_path": "/etc/vault/saml-cert.pem",
        "private_key_path": "/etc/vault/saml-key.pem"
      },
      "oauth2": {
        "enabled": false,
        "authorization_server": "https://oauth.company.com",
        "client_id": "${OAUTH2_CLIENT_ID}",
        "client_secret": "${OAUTH2_CLIENT_SECRET}",
        "scopes": ["vault.read", "vault.write", "vault.admin"]
      },
      "pki_integration": {
        "enabled": false,
        "root_ca": "/etc/vault/ca.pem",
        "intermediate_ca": "/etc/vault/intermediate.pem",
        "crl_distribution_point": "https://pki.company.com/crl",
        "ocsp_responder": "https://ocsp.company.com"
      }
    },
    
    "high_availability": {
      "enabled": true,
      "cluster_mode": "raft",
      "node_count": 5,
      "auto_failover": true,
      "backup_schedule": "0 2 * * *",
      "replication": {
        "enabled": true,
        "mode": "dr",
        "regions": ["us-east-1", "us-west-2", "eu-west-1"],
        "sync_interval": 300
      },
      "load_balancer": {
        "enabled": true,
        "health_check_path": "/v1/sys/health",
        "health_check_interval": 30
      }
    },
    
    "monitoring": {
      "metrics_enabled": true,
      "telemetry_endpoint": "https://telemetry.company.com/vault",
      "prometheus_metrics": true,
      "grafana_dashboard": true,
      "alerting": {
        "enabled": true,
        "webhook_url": "https://alerts.company.com/webhook",
        "critical_threshold": 0.9,
        "warning_threshold": 0.7
      }
    },
    
    "performance": {
      "cache_size": "512MB",
      "max_connections": 1000,
      "connection_timeout": 30,
      "read_timeout": 60,
      "write_timeout": 60,
      "batch_processing": {
        "enabled": true,
        "batch_size": 1000,
        "flush_interval": 5
      }
    },
    
    "security": {
      "tls_version": "1.3",
      "cipher_suites": [
        "TLS_AES_256_GCM_SHA384",
        "TLS_CHACHA20_POLY1305_SHA256",
        "TLS_AES_128_GCM_SHA256"
      ],
      "certificate_path": "/etc/vault/tls.crt",
      "private_key_path": "/etc/vault/tls.key",
      "ca_cert_path": "/etc/vault/ca.crt",
      "client_auth_required": true,
      "session_timeout": 3600,
      "max_failed_attempts": 5,
      "lockout_duration": 300
    }
  },
  
  "claudeops": {
    "haivemind": {
      "agent_id": "vault_security_agent",
      "role": "security_vault",
      "capabilities": [
        "credential_monitoring",
        "access_control",
        "authentication_analysis", 
        "privilege_management",
        "security_compliance",
        "threat_detection",
        "anomaly_detection",
        "incident_response"
      ],
      "specialization": "credential_security",
      "broadcast_discoveries": true,
      "accept_delegated_tasks": true,
      "share_threat_intelligence": true,
      "collaborate_on_incidents": true
    }
  },
  
  "logging": {
    "level": "INFO",
    "format": "json",
    "audit_log": "/var/log/vault/audit.log",
    "security_log": "/var/log/vault/security.log",
    "compliance_log": "/var/log/vault/compliance.log",
    "rotation": {
      "enabled": true,
      "max_size": "100MB",
      "max_files": 10,
      "compress": true
    }
  },
  
  "storage": {
    "backend": "raft",
    "raft_storage_path": "/opt/vault/data/raft",
    "cluster_addr": "https://vault.company.com:8201",
    "api_addr": "https://vault.company.com:8200",
    "encryption": {
      "enabled": true,
      "key_derivation": "pbkdf2",
      "iterations": 100000
    }
  }
}